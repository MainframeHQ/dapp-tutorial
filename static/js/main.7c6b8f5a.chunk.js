(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{209:function(e){e.exports=[{constant:!1,inputs:[],name:"renounceOwnership",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"owner",outputs:[{name:"",type:"address"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"_newOwner",type:"address"}],name:"transferOwnership",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{anonymous:!1,inputs:[{indexed:!0,name:"previousOwner",type:"address"}],name:"OwnershipRenounced",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"previousOwner",type:"address"},{indexed:!0,name:"newOwner",type:"address"}],name:"OwnershipTransferred",type:"event"},{constant:!1,inputs:[{name:"name",type:"bytes32"}],name:"addCandidate",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"getCandidateCount",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"index",type:"uint256"}],name:"getCandidateNameForIndex",outputs:[{name:"",type:"bytes32"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[],name:"registerVoter",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"getRegistrationCount",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"index",type:"uint256"}],name:"getRegistrationForIndex",outputs:[{name:"",type:"address"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"voterAddr",type:"address"}],name:"approveRegistration",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"voterAddresses",type:"address[]"}],name:"approveRegistrations",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"voterAddr",type:"address"}],name:"voterIsRegistered",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"voterAddr",type:"address"}],name:"registrationIsApproved",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"voterAddr",type:"address"}],name:"voterHasVoted",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"name",type:"bytes32"}],name:"voteForCandidate",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"name",type:"bytes32"}],name:"getVoteCountForCandidate",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"}]},220:function(e,t,a){e.exports=a(567)},225:function(e,t,a){},260:function(e,t){},262:function(e,t){},287:function(e,t){},332:function(e,t){},567:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(28),s=a.n(o),i=(a(225),a(219)),c=a(18),u=a.n(c),l=a(36),d=a(31),p=a(32),m=a(34),h=a(33),v=a(35),f=a(208),b=a.n(f),g=a(23),y=a.n(g),w=a(88),E=a(209),x={en:{dappName:"Mainframe - Election Dapp",homeError:"Oops, seems like you don't have MetaMask installed or you're connected to the wrong network.",admTitle:"Admin Area",electorsWaiting:"Voters waiting for approval",approveButton:"Approve",addCandidateTitle:"Add Candidate",candidateField:"Candidate name",saveButton:"Save",electorTitle:"Voter Area",candidatesTitle:"Presidential Candidates",noCandidates:"No candidates available.",thanksVoted:"Thanks! Your vote has been computed!",pendingApproval:"Your request is waiting to be approved!",voteButton:"Vote",requestTitle:"You need to request admin approval to be able to vote,",ethAddress:"Your ETH address is:",requestAccessButton:"Request Access"},pt:{dappName:"Mainframe - Dapp de Elei\xe7\xf5es",homeError:"Eita, parece que voc\xea n\xe3o tem o MetaMask instalado, ou n\xe3o est\xe1 conectado na rede correta.",admTitle:"\xc1rea do Administrador",electorsWaiting:"Eleitores esperando aprova\xe7\xe3o.",approveButton:"Aprovar",addCandidateTitle:"Cadastrar um candidato",candidateField:"Nome do Candidato",saveButton:"Salvar",electorTitle:"\xc1rea do Eleitor",candidatesTitle:"Candidatos \xe0 presid\xeancia da rep\xfablica",noCandidates:"N\xe3o existem candidatos cadastrados.",thanksVoted:"Obrigado! Seu voto j\xe1 foi computado!",pendingApproval:"Sua solicita\xe7\xe3o est\xe1 aguardando aprova\xe7\xe3o!",voteButton:"Votar",requestTitle:"Para votar, voc\xea precisa solicitar acesso ao Administrador,",ethAddress:"O seu endere\xe7o ETH \xe9:",requestAccessButton:"Solicitar Acesso"}},k=Object(n.createContext)({language:"en",messages:x.en,user:{},candidates:[],pendingVoters:[],vote:function(e){return null},approve:function(e){return null},requestApproval:function(e){return null},setLanguage:function(e){}}),C=k.Provider,O=k.Consumer,j=function(e){return function(t){return r.a.createElement(O,null,function(a){return r.a.createElement(e,Object.assign({},t,a))})}},A=a(24),N=a(21),T=a.n(N),S=a(46),M=a.n(S),V=a(47),q=a.n(V),F=a(67),B=a.n(F),R=a(37),I=a.n(R),W=a(210),P=a.n(W),L=a(212),H=a.n(L),D=a(66),Y=a.n(D),G=a(89),J=a.n(G),U=Object(A.withStyles)(function(e){return{badge:{top:10,right:"auto",left:0},candidate:{fontSize:16,padding:"10px 0 10px ".concat(4*e.spacing.unit,"px!important")},selected:{background:"yellow",color:"white"}}})(function(e){var t=e.classes,a=e.name,n=e.votes,o=e.onSelect,s=[];return e.selected&&s.push(t.selected),r.a.createElement(r.a.Fragment,null,r.a.createElement(P.a,null),r.a.createElement(Y.a,{role:void 0,dense:!0,button:!0,onClick:function(){return o(a)},className:s},r.a.createElement(H.a,{color:"primary",badgeContent:n,classes:{badge:t.badge}},r.a.createElement(J.a,{primary:a,className:t.candidate}))))}),z=function(e){function t(){var e,a;Object(d.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(m.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(r)))).state={candidate:""},a.selectCandidate=function(e){"approved"===a.props.user.registration&&!a.props.user.voted&&a.setState({candidate:e})},a.vote=function(){a.props.vote(a.state.candidate),a.setState({candidate:""})},a}return Object(v.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.classes,n=t.candidates,o=t.user,s=t.messages;return r.a.createElement(r.a.Fragment,null,r.a.createElement(T.a,{variant:"h5",component:"h1",className:a.electorTitle},s.electorTitle),r.a.createElement(M.a,{className:a.card},r.a.createElement(q.a,null,r.a.createElement(T.a,{variant:"h5",component:"h2",className:a.title},n.length>0?s.candidatesTitle:s.noCandidates),r.a.createElement(B.a,null,n.map(function(t,a){return r.a.createElement(U,{onSelect:e.selectCandidate,selected:!o.voted&&"approved"===o.registration&&e.state.candidate===t.name,key:"candidate-".concat(a),name:t.name,votes:t.votes})})),o.voted&&r.a.createElement(T.a,{variant:"h6",component:"h2",className:a.title},s.thanksVoted),"pendingApproval"===o.registration&&r.a.createElement(T.a,{variant:"h6",component:"h2",className:a.title},s.pendingApproval)),"approved"===o.registration&&!o.voted&&r.a.createElement(I.a,{disabled:!this.state.candidate,variant:"contained",color:"primary",onClick:this.vote,className:a.button},s.voteButton)))}}]),t}(n.Component),$=j(Object(A.withStyles)(function(){return{electorTitle:{marginTop:60},title:{padding:"20px 0"},card:{marginTop:20,minWidth:275,width:"80vw"},button:{margin:"20px auto",display:"block"}}})(z)),_=a(218),K=a(213),Q=a.n(K),X=a(214),Z=a.n(X),ee=function(e){function t(){var e,a;Object(d.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(m.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(r)))).state={checked:[],name:""},a.toggleItem=function(e){-1!==a.state.checked.indexOf(e)?a.setState({checked:a.state.checked.filter(function(t){return t!==e})}):a.setState({checked:Object(_.a)(a.state.checked).concat([e])})},a.approve=function(){a.props.batchApprove(a.state.checked),a.setState({checked:[]})},a.setName=function(e){a.setState({name:e.target.value})},a.registerCandidate=function(){a.props.addCandidate(a.state.name.substring(0,32)),a.setState({name:""})},a}return Object(v.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.classes,n=t.pendingVoters,o=t.messages;return r.a.createElement(r.a.Fragment,null,r.a.createElement(T.a,{variant:"h5",component:"h1",className:a.adminTile},o.admTitle),r.a.createElement(M.a,{className:a.card},r.a.createElement(q.a,null,r.a.createElement(T.a,{variant:"h5",component:"h2",className:a.title},o.electorsWaiting),r.a.createElement(B.a,null,n.map(function(t){return r.a.createElement(Y.a,{key:t,role:void 0,dense:!0,button:!0,onClick:function(){return e.toggleItem(t)}},r.a.createElement(Q.a,{checked:-1!==e.state.checked.indexOf(t),tabIndex:-1,disableRipple:!0}),r.a.createElement(J.a,{primary:t}))})),r.a.createElement(I.a,{disabled:0===this.state.checked.length,variant:"contained",color:"primary",onClick:this.approve,className:a.button},o.approveButton))),r.a.createElement(M.a,{className:a.card},r.a.createElement(q.a,null,r.a.createElement(T.a,{variant:"h5",component:"h2",className:a.title},o.addCandidateTitle),r.a.createElement(Z.a,{required:!0,onChange:this.setName,id:"outlined-required",label:o.candidateField,className:a.textField,margin:"normal",variant:"outlined",value:this.state.name}),r.a.createElement(I.a,{disabled:0===this.state.name.length||Object(w.findIndex)(this.props.candidates,function(t){return t.name===e.state.name})>=0,variant:"contained",color:"primary",onClick:this.registerCandidate,className:a.button},o.saveButton))))}}]),t}(n.Component),te=j(Object(A.withStyles)(function(){return{adminTile:{marginTop:60},title:{padding:"20px 0"},card:{marginTop:20,minWidth:275,width:"80vw"},button:{margin:"20px auto",display:"block"},textField:{width:"100%"}}})(ee)),ae=function(e){function t(){return Object(d.a)(this,t),Object(m.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.user,n=e.messages;return"pendingRegistration"===a.registration?r.a.createElement(M.a,{className:t.card},r.a.createElement(q.a,null,r.a.createElement(T.a,{variant:"h5",component:"h2",className:t.title},n.requestTitle),r.a.createElement(T.a,{variant:"h6",component:"h5",className:t.title},n.ethAddress," ",a.address),r.a.createElement(I.a,{variant:"contained",color:"primary",onClick:this.props.requestApproval,className:t.button},n.requestAccessButton))):null}}]),t}(n.Component),ne=j(Object(A.withStyles)(function(){return{title:{padding:"20px 0"},card:{marginTop:20,minWidth:275,width:"80vw"},button:{margin:"20px auto",display:"block"},textField:{width:"100%"}}})(ae)),re=a(215),oe=a.n(re),se=a(216),ie=a.n(se),ce=a(217),ue=a.n(ce),le=a(120),de=a.n(le),pe=function(e){function t(){var e,a;Object(d.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(m.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(r)))).state={anchorEl:null},a.handleClick=function(e){a.setState({anchorEl:e.currentTarget})},a.handleClose=function(e){a.props.setLanguage(e),a.setState({anchorEl:null})},a}return Object(v.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.classes,n=t.messages,o=t.language,s=this.state.anchorEl;return r.a.createElement(oe.a,{className:a.bar,position:"static"},r.a.createElement(ie.a,null,r.a.createElement(T.a,{variant:"h6",color:"inherit",className:a.grow},n.dappName),r.a.createElement(I.a,{"aria-owns":s?"simple-menu":void 0,"aria-haspopup":"true",onClick:this.handleClick,className:a.language},"en"===o?"English":"Portugu\xeas (BR)"),r.a.createElement(ue.a,{id:"simple-menu",anchorEl:s,open:Boolean(s),onClose:this.handleClose},r.a.createElement(de.a,{onClick:function(){return e.handleClose("en")}},"English"),r.a.createElement(de.a,{onClick:function(){return e.handleClose("pt")}},"Portugu\xeas (BR)"))))}}]),t}(n.Component),me=j(Object(A.withStyles)(function(){return{bar:{height:70},grow:{flexGrow:1},language:{color:"white"}}})(pe)),he=Object(A.withStyles)(function(){return{error:{flexGrow:1,padding:20,color:"red",textAlign:"center"}}})(function(e){var t=e.classes,a=e.message;return r.a.createElement(T.a,{variant:"h6",color:"inherit",className:t.error},a)}),ve=j(Object(A.withStyles)(function(){return{root:{minHeight:"100vh",flex:1,flexGrow:1,background:"#d3d3d3"},main:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"}}})(function(e){var t=e.classes,a=e.user,n=e.messages;return r.a.createElement("div",{className:t.root},r.a.createElement(me,null),r.a.createElement("div",{className:t.main},a.address?r.a.createElement(r.a.Fragment,null,r.a.createElement($,null),r.a.createElement(ne,null),a.admin&&r.a.createElement(te,null)):r.a.createElement(he,{message:n.homeError})))})),fe="0x8700269ffb81ace4784ab27ecf9a633326c478e3",be=function(e){function t(e){var a;Object(d.a)(this,t),(a=Object(m.a)(this,Object(h.a)(t).call(this,e))).vote=function(){var e=Object(l.a)(u.a.mark(function e(t){var n,r,o;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.state.contract){e.next=3;break}return e.abrupt("return",new Error("Not connected to Web3"));case 3:return r=y.a.utf8ToHex(t),o=a.state.user.address,e.abrupt("return",new Promise(function(e,t){n.methods.voteForCandidate(r).send({from:o}).on("error",function(e){t(e)}).on("receipt",function(t){e(t)})}));case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),a.approve=function(){var e=Object(l.a)(u.a.mark(function e(t){var n,r;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.state.contract){e.next=3;break}return e.abrupt("return",new Error("Not connected to Web3"));case 3:return r=a.state.user.address,e.abrupt("return",new Promise(function(e,a){n.methods.approveRegistration(t).send({from:r}).on("error",function(e){a(e)}).on("receipt",function(t){e(t)})}));case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),a.addCandidate=function(){var e=Object(l.a)(u.a.mark(function e(t){var n,r,o;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.state.contract){e.next=3;break}return e.abrupt("return",new Error("Not connected to Web3"));case 3:return r=y.a.utf8ToHex(t),o=a.state.user.address,e.abrupt("return",new Promise(function(e,t){n.methods.addCandidate(r).send({from:o}).on("error",function(e){t(e)}).on("receipt",function(t){e(t),a.getContractState()})}));case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),a.requestApproval=Object(l.a)(u.a.mark(function e(){var t,n;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.state.contract){e.next=3;break}return e.abrupt("return",new Error("Not connected to Web3"));case 3:return n=a.state.user.address,e.abrupt("return",new Promise(function(e,a){t.methods.registerVoter().send({from:n}).on("error",function(e){a(e)}).on("receipt",function(t){e(t)})}));case 5:case"end":return e.stop()}},e,this)})),a.batchApprove=function(){var e=Object(l.a)(u.a.mark(function e(t){var n,r;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.state.contract){e.next=3;break}return e.abrupt("return",new Error("Not connected to Web3"));case 3:return r=a.state.user.address,e.abrupt("return",new Promise(function(e,a){n.methods.approveRegistrations(t).send({from:r}).on("error",function(e){a(e)}).on("receipt",function(t){e(t)})}));case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),a.setLanguage=function(e){a.setState({language:e})};var n={language:"pt",user:{},candidates:[],pendingVoters:[]};return window.web3&&(n.web3=new b.a(window.web3.currentProvider),n.contract=new n.web3.eth.Contract(E,fe)),a.state=n,a}return Object(v.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){var e=Object(l.a)(u.a.mark(function e(){var t=this;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.getContractState(),this.timeout=setInterval(function(){return t.getContractState()},2e3);case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){this.timeout&&this.timeout()}},{key:"getContractState",value:function(){var e=Object(l.a)(u.a.mark(function e(){var t,a,n,r,o,s,i,c,l,d;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.state,a=t.web3,n=t.contract,!a||!n){e.next=35;break}return e.prev=2,e.next=5,a.eth.getCoinbase();case 5:return r=e.sent,e.next=8,n.methods.voterIsRegistered(r).call();case 8:return o=e.sent,e.next=11,n.methods.owner().call();case 11:if(s=e.sent,i={registration:o?"pendingApproval":"pendingRegistration",admin:s.toLowerCase()===r.toLowerCase(),address:r.toLowerCase()},!o){e.next=23;break}return e.next=16,n.methods.registrationIsApproved(r).call();case 16:if(!e.sent){e.next=23;break}return i.registration="approved",e.next=21,n.methods.voterHasVoted(r).call();case 21:c=e.sent,i.voted=c;case 23:return e.next=25,this.fetchCandidates(this.state.contract);case 25:return l=e.sent,e.next=28,this.fetchPendingVoters();case 28:d=e.sent,this.setState({pendingVoters:Object(w.uniq)(d),candidates:l,user:i}),e.next=35;break;case 32:e.prev=32,e.t0=e.catch(2),console.warn("err: ",e.t0);case 35:case"end":return e.stop()}},e,this,[[2,32]])}));return function(){return e.apply(this,arguments)}}()},{key:"fetchCandidates",value:function(){var e=Object(l.a)(u.a.mark(function e(){var t,a,n,r,o,s;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state.contract,a=[],e.next=4,t.methods.getCandidateCount().call();case 4:n=e.sent,r=0;case 6:if(!(r<n)){e.next=17;break}return e.next=9,t.methods.getCandidateNameForIndex(r).call();case 9:return o=e.sent,e.next=12,t.methods.getVoteCountForCandidate(o).call();case 12:s=e.sent,a.push({name:y.a.hexToUtf8(o),votes:s});case 14:r++,e.next=6;break;case 17:return e.abrupt("return",a);case 18:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"fetchPendingVoters",value:function(){var e=Object(l.a)(u.a.mark(function e(){var t,a,n,r,o;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state.contract,a=[],e.next=4,t.methods.getRegistrationCount().call();case 4:n=e.sent,r=0;case 6:if(!(r<n)){e.next=17;break}return e.next=9,t.methods.getRegistrationForIndex(r).call();case 9:return o=e.sent,e.next=12,t.methods.registrationIsApproved(o).call();case 12:e.sent||a.push(o);case 14:r++,e.next=6;break;case 17:return e.abrupt("return",a);case 18:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return this.state.web3?r.a.createElement(C,{value:Object(i.a)({vote:this.vote,approve:this.approve,requestApproval:this.requestApproval,addCandidate:this.addCandidate,batchApprove:this.batchApprove,messages:x[this.state.language],setLanguage:this.setLanguage},this.state)},r.a.createElement(ve,null)):r.a.createElement("span",null,x.en.homeError)}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(be,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[220,2,1]]]);
//# sourceMappingURL=main.7c6b8f5a.chunk.js.map