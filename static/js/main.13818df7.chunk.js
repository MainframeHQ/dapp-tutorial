(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{202:function(e){e.exports=[{constant:!1,inputs:[],name:"renounceOwnership",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"owner",outputs:[{name:"",type:"address"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"_newOwner",type:"address"}],name:"transferOwnership",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{anonymous:!1,inputs:[{indexed:!0,name:"previousOwner",type:"address"}],name:"OwnershipRenounced",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"previousOwner",type:"address"},{indexed:!0,name:"newOwner",type:"address"}],name:"OwnershipTransferred",type:"event"},{constant:!1,inputs:[{name:"name",type:"bytes32"}],name:"addCandidate",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"getCandidateCount",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"index",type:"uint256"}],name:"getCandidateNameForIndex",outputs:[{name:"",type:"bytes32"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[],name:"registerVoter",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"getRegistrationCount",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"index",type:"uint256"}],name:"getRegistrationForIndex",outputs:[{name:"",type:"address"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"voterAddr",type:"address"}],name:"approveRegistration",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"voterAddresses",type:"address[]"}],name:"approveRegistrations",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"voterAddr",type:"address"}],name:"voterIsRegistered",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"voterAddr",type:"address"}],name:"registrationIsApproved",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"voterAddr",type:"address"}],name:"voterHasVoted",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"name",type:"bytes32"}],name:"voteForCandidate",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"name",type:"bytes32"}],name:"getVoteCountForCandidate",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"}]},213:function(e,t,a){e.exports=a(554)},218:function(e,t,a){},253:function(e,t){},255:function(e,t){},280:function(e,t){},323:function(e,t){},554:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(28),s=a.n(o),i=(a(218),a(212)),c=a(18),u=a.n(c),d=a(31),l=a(35),p=a(36),m=a(38),h=a(37),v=a(39),f=a(201),b=a.n(f),y=a(23),g=a.n(y),w=a(202),x={en:{dappName:"Mainframe MeetUp - Elections Dapp",homeError:"Oops, seems like you don't have MetaMask installed or you're connected to the wrong network.",admTitle:"Admin Area",electorsWaiting:"Voters waiting for approval",approveButton:"Approve",addCandidateTitle:"Add Candidate",candidateField:"Candidate name",saveButton:"Save",electorTitle:"Voter Area",candidatesTitle:"Presidential Candidates",noCandidates:"No candidates available.",thanksVoted:"Thanks! Your vote has been computed!",pendingApproval:"Your request is waiting to be approved!",voteButton:"Vote",requestTitle:"You need to request admin approval to be able to vote,",ethAddress:"Your ETH address is:",requestAccessButton:"Request Access"},pt:{dappName:"Mainframe MeetUp - Dapp de Elei\xe7\xf5es",homeError:"Eita, parece que voc\xea n\xe3o tem o MetaMask instalado, ou n\xe3o est\xe1 conectado na rede correta.",admTitle:"\xc1rea do Administrador",electorsWaiting:"Eleitores esperando aprova\xe7\xe3o.",approveButton:"Aprovar",addCandidateTitle:"Cadastrar um candidato",candidateField:"Nome do Candidato",saveButton:"Salvar",electorTitle:"\xc1rea do Eleitor",candidatesTitle:"Candidatos \xe0 presid\xeancia da rep\xfablica",noCandidates:"N\xe3o existem candidatos cadastrados.",thanksVoted:"Obrigado! Seu voto j\xe1 foi computado!",pendingApproval:"Sua solicita\xe7\xe3o est\xe1 aguardando aprova\xe7\xe3o!",voteButton:"Votar",requestTitle:"Para votar, voc\xea precisa solicitar acesso ao Administrador,",ethAddress:"O seu endere\xe7o ETH \xe9:",requestAccessButton:"Solicitar Acesso"}},E=Object(n.createContext)({messages:x.en,user:{},candidates:[],pendingVoters:[],vote:function(e){return null},approve:function(e){return null},requestApproval:function(e){return null}}),k=E.Provider,C=E.Consumer,O=function(e){return function(t){return r.a.createElement(C,null,function(a){return r.a.createElement(e,Object.assign({},t,a))})}},j=a(24),A=a(21),N=a.n(A),T=a(44),S=a.n(T),M=a(45),V=a.n(M),F=a(64),q=a.n(F),I=a(46),R=a.n(I),B=a(203),W=a.n(B),P=a(205),H=a.n(P),D=a(86),U=a.n(D),Y=a(87),G=a.n(Y),L=Object(j.withStyles)(function(e){return{badge:{top:10,right:"auto",left:0},candidate:{fontSize:16,padding:"10px 0 10px ".concat(4*e.spacing.unit,"px!important")},selected:{background:"yellow",color:"white"}}})(function(e){var t=e.classes,a=e.name,n=e.votes,o=e.onSelect,s=[];return e.selected&&s.push(t.selected),r.a.createElement(r.a.Fragment,null,r.a.createElement(W.a,null),r.a.createElement(U.a,{role:void 0,dense:!0,button:!0,onClick:function(){return o(a)},className:s},r.a.createElement(H.a,{color:"primary",badgeContent:n,classes:{badge:t.badge}},r.a.createElement(G.a,{primary:a,className:t.candidate}))))}),J=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(m.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(r)))).state={candidate:""},a.selectCandidate=function(e){"approved"===a.props.user.registration&&!a.props.user.voted&&a.setState({candidate:e})},a.vote=function(){a.props.vote(a.state.candidate),a.setState({candidate:""})},a}return Object(v.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.classes,n=t.candidates,o=t.user,s=t.messages;return r.a.createElement(r.a.Fragment,null,r.a.createElement(N.a,{variant:"h5",component:"h1",className:a.electorTitle},s.electorTitle),r.a.createElement(S.a,{className:a.card},r.a.createElement(V.a,null,r.a.createElement(N.a,{variant:"h5",component:"h2",className:a.title},n.length>0?s.candidatesTitle:s.noCandidates),r.a.createElement(q.a,null,n.map(function(t,a){return r.a.createElement(L,{onSelect:e.selectCandidate,selected:!o.voted&&"approved"===o.registration&&e.state.candidate===t.name,key:"candidate-".concat(a),name:t.name,votes:t.votes})})),o.voted&&r.a.createElement(N.a,{variant:"h6",component:"h2",className:a.title},s.thanksVoted),"pendingApproval"===o.registration&&r.a.createElement(N.a,{variant:"h6",component:"h2",className:a.title},s.pendingApproval)),"approved"===o.registration&&!o.voted&&r.a.createElement(R.a,{disabled:!this.state.candidate,variant:"contained",color:"primary",onClick:this.vote,className:a.button},s.voteButton)))}}]),t}(n.Component),z=O(Object(j.withStyles)(function(){return{electorTitle:{marginTop:60},title:{padding:"20px 0"},card:{marginTop:20,minWidth:275,width:"80vw"},button:{margin:"20px auto",display:"block"}}})(J)),$=a(211),_=a(206),K=a(207),Q=a.n(K),X=a(208),Z=a.n(X),ee=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(m.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(r)))).state={checked:[],name:""},a.toggleItem=function(e){-1!==a.state.checked.indexOf(e)?a.setState({checked:a.state.checked.filter(function(t){return t!==e})}):a.setState({checked:Object($.a)(a.state.checked).concat([e])})},a.approve=function(){a.props.batchApprove(a.state.checked),a.setState({checked:[]})},a.setName=function(e){a.setState({name:e.target.value})},a.registerCandidate=function(){a.props.addCandidate(a.state.name.substring(0,32)),a.setState({name:""})},a}return Object(v.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.classes,n=t.pendingVoters,o=t.messages;return r.a.createElement(r.a.Fragment,null,r.a.createElement(N.a,{variant:"h5",component:"h1",className:a.adminTile},o.admTitle),r.a.createElement(S.a,{className:a.card},r.a.createElement(V.a,null,r.a.createElement(N.a,{variant:"h5",component:"h2",className:a.title},o.electorsWaiting),r.a.createElement(q.a,null,n.map(function(t){return r.a.createElement(U.a,{key:t,role:void 0,dense:!0,button:!0,onClick:function(){return e.toggleItem(t)}},r.a.createElement(Q.a,{checked:-1!==e.state.checked.indexOf(t),tabIndex:-1,disableRipple:!0}),r.a.createElement(G.a,{primary:t}))})),r.a.createElement(R.a,{disabled:0===this.state.checked.length,variant:"contained",color:"primary",onClick:this.approve,className:a.button},o.approveButton))),r.a.createElement(S.a,{className:a.card},r.a.createElement(V.a,null,r.a.createElement(N.a,{variant:"h5",component:"h2",className:a.title},o.addCandidateTitle),r.a.createElement(Z.a,{required:!0,onChange:this.setName,id:"outlined-required",label:o.candidateField,className:a.textField,margin:"normal",variant:"outlined",value:this.state.name}),r.a.createElement(R.a,{disabled:0===this.state.name.length||Object(_.findIndex)(this.props.candidates,function(t){return t.name===e.state.name})>=0,variant:"contained",color:"primary",onClick:this.registerCandidate,className:a.button},o.saveButton))))}}]),t}(n.Component),te=O(Object(j.withStyles)(function(){return{adminTile:{marginTop:60},title:{padding:"20px 0"},card:{marginTop:20,minWidth:275,width:"80vw"},button:{margin:"20px auto",display:"block"},textField:{width:"100%"}}})(ee)),ae=function(e){function t(){return Object(l.a)(this,t),Object(m.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.user,n=e.messages;return"pendingRegistration"===a.registration?r.a.createElement(S.a,{className:t.card},r.a.createElement(V.a,null,r.a.createElement(N.a,{variant:"h5",component:"h2",className:t.title},n.requestTitle),r.a.createElement(N.a,{variant:"h6",component:"h5",className:t.title},n.ethAddress," ",a.address),r.a.createElement(R.a,{variant:"contained",color:"primary",onClick:this.props.requestApproval,className:t.button},n.requestAccessButton))):null}}]),t}(n.Component),ne=O(Object(j.withStyles)(function(){return{title:{padding:"20px 0"},card:{marginTop:20,minWidth:275,width:"80vw"},button:{margin:"20px auto",display:"block"},textField:{width:"100%"}}})(ae)),re=a(209),oe=a.n(re),se=a(210),ie=a.n(se),ce=O(Object(j.withStyles)(function(){return{bar:{height:70},grow:{flexGrow:1}}})(function(e){var t=e.classes,a=e.messages;return r.a.createElement(oe.a,{className:t.bar,position:"static"},r.a.createElement(ie.a,null,r.a.createElement(N.a,{variant:"h6",color:"inherit",className:t.grow},a.dappName)))})),ue=Object(j.withStyles)(function(){return{error:{flexGrow:1,padding:20,color:"red",textAlign:"center"}}})(function(e){var t=e.classes,a=e.message;return r.a.createElement(N.a,{variant:"h6",color:"inherit",className:t.error},a)}),de=O(Object(j.withStyles)(function(){return{root:{minHeight:"100vh",flex:1,flexGrow:1,background:"#d3d3d3"},main:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"}}})(function(e){var t=e.classes,a=e.user,n=e.messages;return r.a.createElement("div",{className:t.root},r.a.createElement(ce,null),r.a.createElement("div",{className:t.main},a.address?r.a.createElement(r.a.Fragment,null,r.a.createElement(z,null),r.a.createElement(ne,null),a.admin&&r.a.createElement(te,null)):r.a.createElement(ue,{message:n.homeError})))})),le="0x8aec984448c053d8d3ba66056593656e260b042a",pe=function(e){function t(e){var a;Object(l.a)(this,t),(a=Object(m.a)(this,Object(h.a)(t).call(this,e))).vote=function(){var e=Object(d.a)(u.a.mark(function e(t){var n,r,o;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.state.contract){e.next=3;break}return e.abrupt("return",new Error("Not connected to Web3"));case 3:return r=g.a.utf8ToHex(t),o=a.state.user.address,e.abrupt("return",new Promise(function(e,t){n.methods.voteForCandidate(r).send({from:o}).on("error",function(e){t(e)}).on("receipt",function(t){e(t)})}));case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),a.approve=function(){var e=Object(d.a)(u.a.mark(function e(t){var n,r;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.state.contract){e.next=3;break}return e.abrupt("return",new Error("Not connected to Web3"));case 3:return r=a.state.user.address,e.abrupt("return",new Promise(function(e,a){n.methods.approveRegistration(t).send({from:r}).on("error",function(e){a(e)}).on("receipt",function(t){e(t)})}));case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),a.addCandidate=function(){var e=Object(d.a)(u.a.mark(function e(t){var n,r,o;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.state.contract){e.next=3;break}return e.abrupt("return",new Error("Not connected to Web3"));case 3:return r=g.a.utf8ToHex(t),o=a.state.user.address,e.abrupt("return",new Promise(function(e,t){n.methods.addCandidate(r).send({from:o}).on("error",function(e){t(e)}).on("receipt",function(t){e(t),a.getContractState()})}));case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),a.requestApproval=Object(d.a)(u.a.mark(function e(){var t,n;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.state.contract){e.next=3;break}return e.abrupt("return",new Error("Not connected to Web3"));case 3:return n=a.state.user.address,e.abrupt("return",new Promise(function(e,a){t.methods.registerVoter().send({from:n}).on("error",function(e){a(e)}).on("receipt",function(t){e(t)})}));case 5:case"end":return e.stop()}},e,this)})),a.batchApprove=function(){var e=Object(d.a)(u.a.mark(function e(t){var n,r;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.state.contract){e.next=3;break}return e.abrupt("return",new Error("Not connected to Web3"));case 3:return r=a.state.user.address,e.abrupt("return",new Promise(function(e,a){n.methods.approveRegistrations(t).send({from:r}).on("error",function(e){a(e)}).on("receipt",function(t){e(t)})}));case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}();var n={user:{},candidates:[],pendingVoters:[]};return window.web3&&(n.web3=new b.a(window.web3.currentProvider),n.contract=new n.web3.eth.Contract(w,le)),a.state=n,a}return Object(v.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){var e=Object(d.a)(u.a.mark(function e(){var t=this;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.getContractState(),this.timeout=setInterval(function(){return t.getContractState()},2e3);case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){this.timeout&&this.timeout()}},{key:"getContractState",value:function(){var e=Object(d.a)(u.a.mark(function e(){var t,a,n,r,o,s,i,c,d,l;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.state,a=t.web3,n=t.contract,!a||!n){e.next=35;break}return e.prev=2,e.next=5,a.eth.getCoinbase();case 5:return r=e.sent,e.next=8,n.methods.voterIsRegistered(r).call();case 8:return o=e.sent,e.next=11,n.methods.owner().call();case 11:if(s=e.sent,i={registration:o?"pendingApproval":"pendingRegistration",admin:s.toLowerCase()===r.toLowerCase(),address:r.toLowerCase()},!o){e.next=23;break}return e.next=16,n.methods.registrationIsApproved(r).call();case 16:if(!e.sent){e.next=23;break}return i.registration="approved",e.next=21,n.methods.voterHasVoted(r).call();case 21:c=e.sent,i.voted=c;case 23:return e.next=25,this.fetchCandidates(this.state.contract);case 25:return d=e.sent,e.next=28,this.fetchPendingVoters();case 28:l=e.sent,this.setState({pendingVoters:l,candidates:d,user:i}),e.next=35;break;case 32:e.prev=32,e.t0=e.catch(2),console.warn("err: ",e.t0);case 35:case"end":return e.stop()}},e,this,[[2,32]])}));return function(){return e.apply(this,arguments)}}()},{key:"fetchCandidates",value:function(){var e=Object(d.a)(u.a.mark(function e(){var t,a,n,r,o,s;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state.contract,a=[],e.next=4,t.methods.getCandidateCount().call();case 4:n=e.sent,r=0;case 6:if(!(r<n)){e.next=17;break}return e.next=9,t.methods.getCandidateNameForIndex(r).call();case 9:return o=e.sent,e.next=12,t.methods.getVoteCountForCandidate(o).call();case 12:s=e.sent,a.push({name:g.a.hexToUtf8(o),votes:s});case 14:r++,e.next=6;break;case 17:return e.abrupt("return",a);case 18:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"fetchPendingVoters",value:function(){var e=Object(d.a)(u.a.mark(function e(){var t,a,n,r,o;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state.contract,a=[],e.next=4,t.methods.getRegistrationCount().call();case 4:n=e.sent,r=0;case 6:if(!(r<n)){e.next=17;break}return e.next=9,t.methods.getRegistrationForIndex(r).call();case 9:return o=e.sent,e.next=12,t.methods.registrationIsApproved(o).call();case 12:e.sent||a.push(o);case 14:r++,e.next=6;break;case 17:return e.abrupt("return",a);case 18:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return this.state.web3?r.a.createElement(k,{value:Object(i.a)({vote:this.vote,approve:this.approve,requestApproval:this.requestApproval,addCandidate:this.addCandidate,batchApprove:this.batchApprove,messages:x.en},this.state)},r.a.createElement(de,null)):r.a.createElement("span",null,"Please install metamask to use this app.")}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(pe,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[213,2,1]]]);
//# sourceMappingURL=main.13818df7.chunk.js.map